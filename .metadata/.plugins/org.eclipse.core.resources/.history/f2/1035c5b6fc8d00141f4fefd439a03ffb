package TestSuite;

/*
 * Log in as Publisher using Admin details and Verify Deal listing UI 
 */

import java.util.concurrent.TimeUnit;

import org.junit.Assert;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.NoSuchElementException;

import LibraryPackage.Project_Interface_Definations;

public class TC_777_Publisher_With_Admin_Rights_Verify_Deal_Listing_Page extends Project_Interface_Definations{
	 
	@Test
	 public void Verify_Deal_Listing_Page() throws Exception {
			LogIn_As_Publisher_Using_Admin_Rights("admin@pubmatic.com","test","24011"); 

		    //Verify Date filter and its contents    		
		    Assert.assertTrue("Yesterday is not present in date filter",isElementPresent(By.xpath("//a[text()='Yesterday']")));
		    
		    String[] Verify_Texts = {"Active","Scheduled","Paused","Completed"};
		    for (int i = 0; i < Verify_Texts.length; i++)
		    {  
		    	Assert.assertTrue( Verify_Texts[i] + "text is not present on web page ", driver.getPageSource().contains(Verify_Texts[i])); 
		    }
		    
		    //Find and verify Pause Button     
		    Assert.assertTrue("Resume button not present", driver.findElement(By.xpath("//button[text()='Pause']")).isDisplayed());
		    // Verify Resume Button
		    Assert.assertTrue("Resume button not present", driver.findElement(By.xpath("//button[text()='Resume']")).isDisplayed());
		    // verify Edit Button   
		    Assert.assertTrue("Edit button not present", driver.findElement(By.xpath("//button[text()='Edit']")).isDisplayed());    
		    // verify Clone Button   
		    Assert.assertTrue("Clone button not present", driver.findElement(By.xpath("//button[text()='Clone']")).isDisplayed());
		    // Verify Button "+ Add a Deal / Proposal"
		    Assert.assertTrue("Clone button not present", driver.findElement(By.xpath("//button[text()='+ Add a Deal / Proposal']")).isDisplayed());
		    // Verify Button "Download Reports"
		    Assert.assertTrue("Download Report button is not present", driver.findElement(By.xpath("//button[@class='compButton download']")).isDisplayed());
		 
		    //Verify Deal listing table Headers [** Need Code optimization using loop]
		    Assert.assertTrue("Deal Name Header on Deal listing table is not present", driver.findElement(By.xpath("//label[contains(., 'Deal Name')]")).isDisplayed());
		    Assert.assertTrue("Deal ID   Header on Deal listing table is not present", driver.findElement(By.xpath("//label[contains(., 'Deal ID')]")).isDisplayed());
		    Assert.assertTrue("Line Items  Header on Deal listing table is not present", driver.findElement(By.xpath("//label[contains(., 'Line Items')]")).isDisplayed());
		    Assert.assertTrue("Revenue Header on Deal listing table is not present", driver.findElement(By.xpath("//label[contains(., 'Revenue')]")).isDisplayed());
		    Assert.assertTrue("Impressions  Header on Deal listing table is not present", driver.findElement(By.xpath("//label[contains(., 'Impressions')]")).isDisplayed());
		    Assert.assertTrue("eCPM    Header on Deal listing table is not present", driver.findElement(By.xpath("//label[contains(., 'eCPM')]")).isDisplayed());
		    Assert.assertTrue("Status   Header on Deal listing table is not present", driver.findElement(By.xpath("//label[contains(., 'Status')]")).isDisplayed());

		    Thread.sleep(20);
		    //Verify total deals on Header and displayed on Pagination table
		    driver.manage().timeouts().implicitlyWait(1, TimeUnit.MINUTES);
		    Assert.assertTrue(" \"Total Deals\" text is not present on web page ", driver.getPageSource().contains("Total Deals"));
		    String total_deals= driver.findElement(By.xpath("//span[@class='compHTMLElement counter compCounter']")).getText();
		    
		    	Thread.sleep(30);
			   if(Integer.parseInt(total_deals) < 25)
				   Assert.assertTrue(" Total Deals Displayed on Header and Paging table does not match "+total_deals, driver.getPageSource().contains("Displaying 1 to "+total_deals+" of "+total_deals+" records"));	
			   else 
				   Assert.assertTrue(" Total Deals Displayed on Header and Paging table does not match "+total_deals, driver.getPageSource().contains("Displaying 1 to 25 of "+total_deals+" records"));

		    //Cleaning Code
		    driver.quit();
	}
	
	    
}
	 

